<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Weekly Forecast</title>
        <link rel="stylesheet" href="stylesheet.css">
    </head>

    <body>
        <h1>Weekly Forecast</h1>
        <div id="weather" class="weather-container"></div>

        <script>
            function getCurrentLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            const latitude = position.coords.latitude;
                            const longitude = position.coords.longitude;
                            fetchWeather(latitude, longitude);
                        },
                        (error) => {
                            console.error("Error fetching location:", error);
                            document.getElementById('weather').innerHTML = `<p>Unable to get location. Please allow location access.</p>`;
                        }
                    );
                } else {
                    document.getElementById('weather').innerHTML = `<p>Geolocation is not supported by your browser.</p>`;
                }
            }
    
            async function fetchWeather(latitude, longitude) {
                const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&daily=temperature_2m_min,temperature_2m_max,weathercode&timezone=auto`;
    
                try {
                    const response = await fetch(apiUrl);
                    const data = await response.json();
                    displayWeather(data);
                } catch (error) {
                    console.error("Error fetching weather data:", error);
                    document.getElementById('weather').innerHTML = `<p>Unable to fetch weather data.</p>`;
                }
            }
    
            function displayWeather(data) {
                const weatherContainer = document.getElementById("weather");
                weatherContainer.innerHTML = "";
    
                const { daily } = data;
                const { time, temperature_2m_min, temperature_2m_max, weathercode } = daily;
    
                const today = new Date().setHours(0, 0, 0, 0);
    
                time.forEach((date, index) => {
                    const forecastDate = new Date(date).setHours(0, 0, 0, 0);
    
                    if (forecastDate >= today) {
                        const dayCard = document.createElement("div");
                        dayCard.className = "day-card";
    
                        const day = new Date(date).toLocaleDateString(undefined, { weekday: 'short' });
                        const minTemp = temperature_2m_min[index];
                        const maxTemp = temperature_2m_max[index];
    
                        dayCard.innerHTML = `
                            <div class="day-name">${day}</div>
                            <div class="temperature">Min: ${minTemp}°C, Max: ${maxTemp}°C</div>
                        `;
    
                        weatherContainer.appendChild(dayCard);
                    }
                });
            }

            getCurrentLocation();
        </script>
    </body>
</html>
